function outImages = SimApplyColorTransform(M,inImages)% outImages = SimApplyColorTransform(M,inImages)% % Apply a color space transformation to the input image% planes (3D matrix).  Matrix is applied from the left,% and we think of each pixel as a column vector when% we apply it.%% 12/18/98  dhb  Wrote it.% Copyright (c) 1999 David Brainard and Philippe Longere.   All rights reserved.% Get sizes.height = size(inImages,1);width = size(inImages,2);numberPlanesIn = size(inImages,3);numberPlanesOut = size(inImages,3); if (size(M,2) ~= numberPlanesIn)	error('Size of M does not match number of image planes');end% Convert input formatinImages = squeeze(reshape(inImages,height*width,1,numberPlanesIn))';% Apply transformoutImages = M*inImages;% Convert output formatoutImages = reshape(outImages',height,width,numberPlanesOut);